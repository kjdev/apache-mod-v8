//apache log (critical error log)
//ap.log(#val#)
ap.log("hi there");

//output
//ap.rputs(#val#)
ap.rputs("Hello, World" + "\n");

//request parameter (method/uri/filename)
//ap.request.#val#
var method = ap.request.method;
var uri = ap.request.uri;
var filename = ap.request.filename;
var ip = ap.request.remote_ip;

ap.rputs("Method = " + method + "\n");
ap.rputs("Uri = " + uri + "\n");
ap.rputs("Filename = " + filename + "\n");
ap.rputs("Remote IP = " + ip + "\n");

//request header
//ap.header(#val#)
//ap.header() : header keys [array]
var host = ap.header("Host");
var user_agent = ap.header("User-Agent");

ap.rputs("Header: Host = " + host + "\n");
ap.rputs("Header: User-Agent = " + user_agent + "\n");

var headers = ap.header();
for (var i = 0; i < headers.length; i ++) {
    ap.rputs(headers[i] + " => " + ap.header(headers[i]) + "\n");
}

//request params
//ap.params(#val#)
var hoge = ap.params("hoge");
var test = ap.params("test");

ap.rputs("Params: hoge = " + hoge + "\n");
ap.rputs("Params: test = " + test + "\n");

//dirname
//ap.dirname(#val#)
var dir = ap.dirname(filename);

ap.rputs(dir + "\n");

//require
//ap.require(#val#)
ap.require(dir + '/sub.v8');

sub_function();
ap.rputs(sud_data + "\n");

//content-type
//ap.content_type("text/html; charset=UTF-8");

//json
var obj = { test: "TEST", hoge:"HOGE" };
ap.rputs(obj + "\n");
ap.rputs(ap.toJson(obj) + "\n");
